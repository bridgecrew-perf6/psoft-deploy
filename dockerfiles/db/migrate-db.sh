#!/bin/bash

set -e

psql --username $POSTGRES_USER --dbname $POSTGRES_USER <<-EOSQL
  CREATE TABLE ADMIN(ID BIGINT NOT NULL);
  CREATE TABLE ORIENTATION_ISSUE(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    RELATED_ISSUE VARCHAR(255),
    TCC_ID BIGINT,
    TCCMATCH_USER_ID BIGINT
  );
  CREATE TABLE PROFESSOR(QUOTA INTEGER, ID BIGINT NOT NULL);
  CREATE TABLE PROFESSOR_INTERESTED_STUDY_AREAS(
    PROFESSOR_ID BIGINT NOT NULL,
    STUDY_AREA_ID BIGINT NOT NULL
  );
  CREATE TABLE PROFESSOR_INTERESTEDTCCS(
    PROFESSOR_ID BIGINT NOT NULL,
    INTERESTEDTCCS_ID BIGINT NOT NULL
  );
  CREATE TABLE PROFESSOR_LABS(
    PROFESSOR_ID BIGINT NOT NULL,
    LABS VARCHAR(255)
  );
  CREATE TABLE PROFESSOR_REGISTEREDTCCS(
    PROFESSOR_ID BIGINT NOT NULL,
    REGISTEREDTCCS_ID BIGINT NOT NULL
  );
  CREATE TABLE STUDENT(
    EXPECTED_CONCLUSION_TERM VARCHAR(255),
    REGISTRATION VARCHAR(255),
    ID BIGINT NOT NULL,
    TCC_ID BIGINT
  );
  CREATE TABLE STUDENT_INTERESTED_STUDY_AREAS(
    STUDENT_ID BIGINT NOT NULL,
    STUDY_AREA_ID BIGINT NOT NULL
  );
  CREATE TABLE STUDENT_ORIENTATION_INTERESTS(
    INTERESTED_STUDENT_ID BIGINT NOT NULL,
    TCC_ID BIGINT NOT NULL
  );
  CREATE TABLE TCC(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DESCRIPTION VARCHAR(255),
    TCC_STATUS INTEGER,
    TERM VARCHAR(255),
    TITLE VARCHAR(255),
    ADVISED_STUDENT_ID BIGINT,
    ADVISOR_ID BIGINT
  );
  CREATE TABLE TCC_INTERESTED_PROFESSORS(
    TCC_ID BIGINT NOT NULL,
    PROFESSOR_ID BIGINT NOT NULL
  );
  CREATE TABLE TCC_INTERESTED_STUDENTS(
    TCC_ID BIGINT NOT NULL,
    STUDENT_ID BIGINT NOT NULL
  );
  CREATE TABLE TCC_STUDY_AREAS(
    TCC_ID BIGINT NOT NULL,
    STUDY_AREA_ID BIGINT NOT NULL
  );
  CREATE TABLE TCCMATCH_USER(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    EMAIL VARCHAR(255),
    FULL_NAME VARCHAR(255),
    PASSWORD VARCHAR(255),
    ROLE INTEGER,
    USERNAME VARCHAR(255)
  );
  CREATE TABLE TCCMATCH_USER_EMAILS(
    TCCMATCH_USER_ID BIGINT NOT NULL,
    EMAILS VARCHAR(255)
  );
  CREATE TABLE STUDY_AREA(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DESCRIPTION VARCHAR(255)
  );
  ALTER TABLE PROFESSOR_INTERESTEDTCCS
  ADD CONSTRAINT UK_R286TXHWDQT8QM4EXRA9UMQ5J UNIQUE(INTERESTEDTCCS_ID);
  ALTER TABLE PROFESSOR_REGISTEREDTCCS
  ADD CONSTRAINT UK_F8DE6RJ8DCL7MFS58TU3SUJG3 UNIQUE(REGISTEREDTCCS_ID);
  ALTER TABLE TCC_INTERESTED_PROFESSORS
  ADD CONSTRAINT FK7MOIKWVVEW2D97VIJERUHF02Y FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE TCC_STUDY_AREAS
  ADD CONSTRAINT FK8M8VU79K3JIJVY77SC3VLRIHW FOREIGN KEY(STUDY_AREA_ID) REFERENCES STUDY_AREA(ID) NOCHECK;
  ALTER TABLE STUDENT_ORIENTATION_INTERESTS
  ADD CONSTRAINT FK3Y50C4RK638JOWFQ5DOKQM41J FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE TCC_STUDY_AREAS
  ADD CONSTRAINT FK8HSWXQ4BIMTHRDEYW98FO3XYM FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE TCC_INTERESTED_STUDENTS
  ADD CONSTRAINT FKJ4V012N56R6SHRPDT5JM8MGWT FOREIGN KEY(STUDENT_ID) REFERENCES STUDENT(ID) NOCHECK;
  ALTER TABLE ORIENTATION_ISSUE
  ADD CONSTRAINT FKGL1IRLNUE2R6U2YHNVDYJL2R4 FOREIGN KEY(TCCMATCH_USER_ID) REFERENCES TCCMATCH_USER(ID) NOCHECK;
  ALTER TABLE STUDENT_ORIENTATION_INTERESTS
  ADD CONSTRAINT FKFITC9QKI4OPTHJWY5VPV3P8T5 FOREIGN KEY(INTERESTED_STUDENT_ID) REFERENCES STUDENT(ID) NOCHECK;
  ALTER TABLE ORIENTATION_ISSUE
  ADD CONSTRAINT FKPUPU6PN14WAOS05YNI6OOVG7N FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE PROFESSOR_INTERESTEDTCCS
  ADD CONSTRAINT FKRDEQXIIM8VS6DL1P0HICUXRB9 FOREIGN KEY(INTERESTEDTCCS_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE PROFESSOR_INTERESTEDTCCS
  ADD CONSTRAINT FKAL6527JR7JXUKHKJP8NV5T0P0 FOREIGN KEY(PROFESSOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE STUDENT_INTERESTED_STUDY_AREAS
  ADD CONSTRAINT FK2M9QWOB07JNNPYRHAG6S22U2V FOREIGN KEY(STUDY_AREA_ID) REFERENCES STUDY_AREA(ID) NOCHECK;
  ALTER TABLE PROFESSOR_REGISTEREDTCCS
  ADD CONSTRAINT FKQ2H2V1FJIGCBY2GMXJUSCL8KP FOREIGN KEY(REGISTEREDTCCS_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE STUDENT_INTERESTED_STUDY_AREAS
  ADD CONSTRAINT FK7TDYG97AMREE2B40A1SW9U99J FOREIGN KEY(STUDENT_ID) REFERENCES STUDENT(ID) NOCHECK;
  ALTER TABLE PROFESSOR_LABS
  ADD CONSTRAINT FKTAC37U55JIGWT4P2JPEWK6882 FOREIGN KEY(PROFESSOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE TCC_INTERESTED_PROFESSORS
  ADD CONSTRAINT FK19P1Y8OJAH1MUPP5N3ES5BUSF FOREIGN KEY(PROFESSOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE TCCMATCH_USER_EMAILS
  ADD CONSTRAINT FKNRWIUVCQKSHDL168K0W4BSUGQ FOREIGN KEY(TCCMATCH_USER_ID) REFERENCES TCCMATCH_USER(ID) NOCHECK;
  ALTER TABLE STUDENT
  ADD CONSTRAINT FKE7VNOJBLQ466E89P0BINKUC5I FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE TCC_INTERESTED_STUDENTS
  ADD CONSTRAINT FKMTV12OT8I1ANDB772SSLYC00E FOREIGN KEY(TCC_ID) REFERENCES TCC(ID) NOCHECK;
  ALTER TABLE STUDENT
  ADD CONSTRAINT FKEIQ7A06F3JQU2FB5LAGUOGPXC FOREIGN KEY(ID) REFERENCES TCCMATCH_USER(ID) NOCHECK;
  ALTER TABLE TCC
  ADD CONSTRAINT FKD3PTQ6PYVOBA45EKS3JELJHI3 FOREIGN KEY(ADVISOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE PROFESSOR
  ADD CONSTRAINT FKRKDB5WLWHQX4HTQJD81G52PDL FOREIGN KEY(ID) REFERENCES TCCMATCH_USER(ID) NOCHECK;
  ALTER TABLE ADMIN
  ADD CONSTRAINT FK5J7H7V5KHD6DPPKEFET7TIC6P FOREIGN KEY(ID) REFERENCES TCCMATCH_USER(ID) NOCHECK;
  ALTER TABLE TCC
  ADD CONSTRAINT FKB7RI1NIOFH3RY28BYO0XR954R FOREIGN KEY(ADVISED_STUDENT_ID) REFERENCES STUDENT(ID) NOCHECK;
  ALTER TABLE PROFESSOR_REGISTEREDTCCS
  ADD CONSTRAINT FKO5J1FS5VF9JL7R1OCY3G9QEFF FOREIGN KEY(PROFESSOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE PROFESSOR_INTERESTED_STUDY_AREAS
  ADD CONSTRAINT FKNIWRUW77XJTWJYOQCW7IH2GSK FOREIGN KEY(PROFESSOR_ID) REFERENCES PROFESSOR(ID) NOCHECK;
  ALTER TABLE PROFESSOR_INTERESTED_STUDY_AREAS
  ADD CONSTRAINT FKJM88TNPPO0GFBIVXD3A6MIJAC FOREIGN KEY(STUDY_AREA_ID) REFERENCES STUDY_AREA(ID) NOCHECK;
  ALTER TABLE TCCMATCH_USER
  ADD CONSTRAINT CONSTRAINT_C PRIMARY KEY(ID);
  ALTER TABLE TCC
  ADD CONSTRAINT CONSTRAINT_1 PRIMARY KEY(ID);
  ALTER TABLE STUDY_AREA
  ADD CONSTRAINT CONSTRAINT_2 PRIMARY KEY(ID);
  ALTER TABLE STUDENT_ORIENTATION_INTERESTS
  ADD CONSTRAINT CONSTRAINT_3B PRIMARY KEY(INTERESTED_STUDENT_ID, TCC_ID);
  ALTER TABLE STUDENT_INTERESTED_STUDY_AREAS
  ADD CONSTRAINT CONSTRAINT_4B PRIMARY KEY(STUDENT_ID, STUDY_AREA_ID);
  ALTER TABLE STUDENT
  ADD CONSTRAINT CONSTRAINT_B PRIMARY KEY(ID);
  ALTER TABLE PROFESSOR_REGISTEREDTCCS
  ADD CONSTRAINT CONSTRAINT_4E PRIMARY KEY(PROFESSOR_ID, REGISTEREDTCCS_ID);
  ALTER TABLE PROFESSOR_INTERESTEDTCCS
  ADD CONSTRAINT CONSTRAINT_4 PRIMARY KEY(PROFESSOR_ID, INTERESTEDTCCS_ID);
  ALTER TABLE PROFESSOR
  ADD CONSTRAINT CONSTRAINT_6 PRIMARY KEY(ID);
  ALTER TABLE ORIENTATION_ISSUE
  ADD CONSTRAINT CONSTRAINT_E PRIMARY KEY(ID);
  ALTER TABLE ADMIN
  ADD CONSTRAINT CONSTRAINT_3 PRIMARY KEY(ID);
EOSQL